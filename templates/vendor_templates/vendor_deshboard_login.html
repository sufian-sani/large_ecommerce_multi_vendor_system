{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="{% static 'admin_deshboard_static/' %}images/favicon.ico">

    <title>DashboardX Admin - Log in </title>
  
	<!-- Bootstrap 4.0-->
	<link rel="stylesheet" href="{% static 'admin_deshboard_static/' %}assets/vendor_components/bootstrap/dist/css/bootstrap.min.css">
	
	<!-- theme style -->
	<link rel="stylesheet" href="{% static 'admin_deshboard_static/' %}css/style.css">
	
	<!-- Admin skins -->
	<link rel="stylesheet" href="{% static 'admin_deshboard_static/' %}css/skin_color.css">	

</head>
<body class="hold-transition theme-blueindigo bg-img" style="background-image: url({% static 'admin_deshboard_static/' %}images/auth-bg/bg-1.jpg);">
	
	<div class="h-p100">
		<div class="row align-items-center justify-content-md-center h-p100">
			<div class="col-lg-4 col-12 h-lg-p100 h-auto bg-dark-opacity-80 depth-4">
				<div class="row l-block p-xl-100 p-lg-50 p-30 h-lg-p100 h-auto">
					<div class="col-12 logo align-self-start">
						<a href="#" class="aut-logo">
							<img src="{% static 'admin_deshboard_static/' %}images/dashboard_logo-main.png" alt="">
						</a>
					</div>
					<div class="col-12 align-self-center">
						<h1 class="title text-white">Welcome to boomboom</h1>

					</div>

				</div>
			</div>
			<div class="col-lg-8 col-12">
				<div class="row justify-content-center no-gutters">
					<div class="col-xl-6 col-lg-7 col-md-6 col-12">
						<div class="bg-opacity-80 depth-4 rounded">
							<div class="content-top-agile p-30 pb-0">
								<h2 class="text-primary text-left">Sign In</h2>							
							</div>
							<div class="p-30">
							    {% if messages %}
								{% for i in messages %}
								<div class="alert alert-danger" role="alert">
								  <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
								  <span class="sr-only">Error:</span>
								  {{i}}
								</div>
								{% endfor %}
								{% endif %}
								<form action="{% url 'cheake_vendor_login_details' %}" method="POST">{% csrf_token %}
									<div class="form-group">
										<div class="input-group mb-3">
											<div class="input-group-prepend">
												<span class="input-group-text bg-transparent"><i class="ti-user"></i></span>
											</div>
											<input type="text" name="vendor_login_phone_number" class="form-control pl-15 bg-transparent plc-black" placeholder="Mobile Number">
										</div>
									</div>
									<div class="form-group">
										<div class="input-group mb-3">
											<div class="input-group-prepend">
												<span class="input-group-text  bg-transparent"><i class="ti-lock"></i></span>
											</div>
											<input type="password" name="vendor_login_Password" class="form-control pl-15 bg-transparent plc-black" placeholder="Password">
										</div>
									</div>
									<div class="form-group">
										<button type="submit" class="btn btn-info btn-block">SIGN IN</button>
									</div>
									<div class="row align-items-center my-30">
										<div class="col">
										  <p class="text-left mb-0"><a href="{% url 'vendor_registration' %}">Register Now!</a></p>
										</div>
										<div class="col">
<!--										  <p class="text-right mb-0"><a href="">Forgot password ?</a></p>-->

											<!-- Button trigger modal -->
											<p class="text-right mb-0">
											<a href="#" data-toggle="modal" data-target="#vendor_forgot_pass">
											  Forgot password ?
											</a>
											</p>

											<!-- Modal -->
											<div class="modal fade" id="vendor_forgot_pass" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
											  <div class="modal-dialog" role="document">
												<div class="modal-content">
												  <div class="modal-header">
													<h5 class="modal-title" id="exampleModalLabel">Forgot Password</h5>
													<button type="button" class="close" data-dismiss="modal" aria-label="Close">
													  <span aria-hidden="true">&times;</span>
													</button>
												  </div>
												  <div class="modal-body">
													<div class="form-group" id="change_interface_forgot_pss">
														<label class="info-title" for="forgot_pass_num">Phone Number <span>*</span></label>
														<div class="row">
															<div class="col-md-2 col-lg-2 col-sm-2"><h4>+88</h4></div>
															<div class="col-md-10 col-lg-10 col-sm-10">
																<input type="number" class="form-control unicase-form-control text-input" id="forgot_pass_num">
															</div>
														</div>
														  <span id="show_forgot_status"></span>
													</div>
												  </div>
												  <div class="modal-footer">
													<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
													<span id="change_forgot_btn">
														<button type="button" onclick="check_phn_num()" class="btn btn-primary">Continue</button>
													</span>
												  </div>
												</div>
											  </div>
											</div>



										</div>
									</div>
								</form>														


							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>


	<!-- jQuery 3 -->
	<script src="{% static 'admin_deshboard_static/' %}assets/vendor_components/jquery-3.3.1/jquery-3.3.1.js"></script>
	
	<!-- fullscreen -->
	<script src="{% static 'admin_deshboard_static/' %}assets/vendor_components/screenfull/screenfull.js"></script>
	
	<!-- popper -->
	<script src="{% static 'admin_deshboard_static/' %}assets/vendor_components/popper/dist/popper.min.js"></script>
	
	<!-- Bootstrap 4.0-->
	<script src="{% static 'admin_deshboard_static/' %}assets/vendor_components/bootstrap/dist/js/bootstrap.min.js"></script>


<script>

//start Forgot password

function check_phn_num(){
    var varforgot_pass_num = document.getElementById('forgot_pass_num').value;
    console.log(varforgot_pass_num)


    if(varforgot_pass_num == ""){
        document.getElementById('show_forgot_status').innerHTML = `<span style="color:red;">Phone Number is Required !</span>`
    }
    else if(varforgot_pass_num.length > 11){
        document.getElementById('show_forgot_status').innerHTML = `<span style="color:red;">Phone Number is not Valid !</span>`
    }
    else if(varforgot_pass_num.length < 11){
        document.getElementById('show_forgot_status').innerHTML = `<span style="color:red;">Phone Number is not Valid !</span>`
    }
    else{
        document.getElementById('show_forgot_status').innerHTML = ""
        document.getElementById("change_forgot_btn").innerHTML = `<button type="button" class="btn btn-warning">Wait..</button>`

        $.ajax({
                url : '{% url 'vendor_check_and_send_otp' %}',
                type : 'POST',
                data : {varforgot_pass_num:varforgot_pass_num}
            })
            .done(function(response){
                console.log(response);
                console.log(varforgot_pass_num)
                if(response=="False"){
                    document.getElementById('show_forgot_status').innerHTML = `<span style="color:red;">This Phone Number Is Not Registered !</span>`
                }
                else{
                    document.getElementById('change_interface_forgot_pss').innerHTML =
                        `<h5>We Sent You An OTP, Please Check !!</h5>
                        <div class="form-group">
                            <label class="info-title" for="First_Name">OTP <span>*</span></label>
                            <input type="number" class="form-control unicase-form-control text-input" id="otp_forgot_pss_value">
                            <span id="otp_status_forgot"></span>
                        </div>

                        <div class="form-group" id="id_otp_btn1">
                            <button class="btn btn-primary" onclick="resent_otp_number_forgot_pass('${varforgot_pass_num}')">Resent the otp?</button>
                        </div>`


                    document.getElementById("change_forgot_btn").innerHTML = `<button type="button" class="btn btn-primary" onclick="submit_otp_forgot('${varforgot_pass_num}', '${response}')">Submit</button>`
                }

            })

    }
}


function resent_otp_number_forgot_pass(varforgot_pass_num){
    console.log('reset_phn_number')
    console.log(varforgot_pass_num)

    document.getElementById('id_otp_btn1').innerHTML = `<button class="btn btn-warning">Resending ...</button>`;

    $.ajax({
                url : '{% url 'vendor_check_and_send_otp' %}',
                type : 'POST',
                data : {varforgot_pass_num:varforgot_pass_num}
            })
            .done(function(response){
                console.log(response);
                console.log(varforgot_pass_num)
                if(response=="False"){
                    document.getElementById('show_forgot_status').innerHTML = `<span style="color:red;">This Phone Number Is Not Registered !</span>`
                }
                else{
                    document.getElementById('change_interface_forgot_pss').innerHTML =
                        `<h5>We Sent You Another OTP, Please Check !!</h5>
                        <div class="form-group">
                            <label class="info-title" for="First_Name">OTP <span>*</span></label>
                            <input type="number" class="form-control unicase-form-control text-input" id="otp_forgot_pss_value">
                            <span id="otp_status_forgot"></span>
                        </div>

                        <div class="form-group" id="id_otp_btn1">
                            <button class="btn btn-primary" onclick="resent_otp_number_forgot_pass('${varforgot_pass_num}')">Resent the otp?</button>
                        </div>`

                    document.getElementById("change_forgot_btn").innerHTML = `<button type="button" class="btn btn-primary" onclick="submit_otp_forgot('${varforgot_pass_num}', '${response}')">Submit</button>`


                }

            })

}



function submit_otp_forgot(varforgot_pass_num, forgot_otp){
    console.log("varforgot_pass_num, forgot_otp")

    console.log(varforgot_pass_num, forgot_otp)

    var typ_otp = document.getElementById('otp_forgot_pss_value').value;
    console.log(typ_otp)


    if(typ_otp == ""){
        document.getElementById('otp_status_forgot').innerHTML = `<span style="color:red;">OTP Field Can Not be Empty !</span>`
    }
    else{
        document.getElementById('otp_status_forgot').innerHTML = ""
        document.getElementById("change_forgot_btn").innerHTML = `<button type="button" class="btn btn-warning">Wait..</button>`

        if(forgot_otp==typ_otp){
            document.getElementById("change_forgot_btn").innerHTML = `<button type="button" class="btn btn-primary" onclick="last_step_forgot_num('${varforgot_pass_num}')">Complete</button>`


            document.getElementById('change_interface_forgot_pss').innerHTML =`<div class="form-group">
                            <label class="info-title" for="sing_Password">Password <span>*</span></label>
                            <input type="password" class="form-control unicase-form-control text-input" id="password_forgot" >
                            <span id="show_forgot_password1"></span>
                        </div>
                         <div class="form-group">
                            <label class="info-title" for="sign_Confirm_Password">Confirm Password <span>*</span></label>
                            <input type="password" class="form-control unicase-form-control text-input" id="confirm_password_forgot" >
                             <span id="show_forgot_password2"></span>
                        </div>`
        }
        else{
            document.getElementById('otp_status_forgot').innerHTML = `<span style="color:red;">OTP Doesn't Match!</span>`
            document.getElementById("change_forgot_btn").innerHTML = ""
        }
    }
}


function last_step_forgot_num(phn_number){

    password_forgot = document.getElementById('password_forgot').value;
    confirm_password_forgot = document.getElementById('confirm_password_forgot').value;
    console.log(password_forgot, confirm_password_forgot)

    if(password_forgot == ""){
        document.getElementById('show_forgot_password1').innerHTML=`<b><span style="color:red;">Password Can not Be Empty !</span></b>`
    }

    else if(confirm_password_forgot == ""){
        document.getElementById('show_forgot_password1').innerHTML=""
        document.getElementById('show_forgot_password2').innerHTML=`<b><span style="color:red;">Confirm Password Can not Be Empty !</span></b>`
    }

    else if(password_forgot != confirm_password_forgot){
        document.getElementById('show_forgot_password2').innerHTML=`<b><span style="color:red;">Paswords Are Not Matched !</span></b>`
    }
    else{
        document.getElementById('show_forgot_password1').innerHTML="";
        document.getElementById('show_forgot_password2').innerHTML="";

        document.getElementById("change_forgot_btn").innerHTML = `<button type="button" class="btn btn-warning">Completing..</button>`

        $.ajax({
                url : '{% url 'vendor_change_password_confirm' %}',
                type : 'POST',
                data : {phn_number:phn_number,password_forgot:password_forgot}
            })
            .done(function(response){
                console.log(response);
                if(response == "True"){
                    location.reload()
                }
            })
    }
}


// end forgot password


</script>

</body>
</html>
